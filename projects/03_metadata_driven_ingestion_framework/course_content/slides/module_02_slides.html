<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 02 — File Formats & Stages | Snowbrix Academy</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&family=Fira+Code:wght@400;500&display=swap');
  :root{--bg:#1A1A2E;--bg2:#16213E;--card:#0F3460;--cyan:#00D4FF;--orange:#FF6B35;--red:#E63946;--green:#06D6A0;--gray:#B0A8A0;--white:#E8E8E8;--dim:#6B7280;}
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--white);overflow:hidden;height:100vh;width:100vw;}
  .slide{display:none;width:100vw;height:100vh;padding:60px 80px;flex-direction:column;justify-content:center;position:relative;}
  .slide.active{display:flex;}
  .sn{position:absolute;bottom:30px;right:40px;font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--dim);}
  .mt{position:absolute;top:30px;left:40px;font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--cyan);letter-spacing:2px;text-transform:uppercase;}
  .bt{position:absolute;bottom:30px;left:40px;font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--dim);}
  h1{font-family:'JetBrains Mono',monospace;font-size:48px;font-weight:700;line-height:1.2;margin-bottom:24px;}
  h2{font-family:'JetBrains Mono',monospace;font-size:36px;font-weight:700;margin-bottom:20px;line-height:1.3;}
  h3{font-family:'JetBrains Mono',monospace;font-size:24px;font-weight:600;margin-bottom:16px;color:var(--cyan);}
  p,li{font-size:22px;line-height:1.6;color:var(--gray);}
  .hl{color:var(--cyan);} .w{color:var(--orange);} .d{color:var(--red);} .g{color:var(--green);}
  ul{list-style:none;padding-left:0;} ul li{padding:8px 0;padding-left:30px;position:relative;}
  ul li::before{content:'>';position:absolute;left:0;color:var(--cyan);font-family:'JetBrains Mono',monospace;font-weight:700;}
  .cb{background:#0D1117;border:1px solid #30363D;border-radius:8px;padding:24px 28px;font-family:'Fira Code',monospace;font-size:17px;line-height:1.7;color:#C9D1D9;margin:20px 0;white-space:pre;overflow:auto;}
  .cb .kw{color:#FF7B72;} .cb .s{color:#A5D6FF;} .cb .c{color:#8B949E;} .cb .fn{color:#D2A8FF;} .cb .n{color:#79C0FF;}
  .g2{display:grid;grid-template-columns:1fr 1fr;gap:40px;margin-top:20px;}
  .g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:30px;margin-top:20px;}
  .cd{background:var(--bg2);border:1px solid #30363D;border-radius:12px;padding:28px;}
  .cd.hc{border-color:var(--cyan);} .cd.wc{border-color:var(--orange);}
  .bn{font-family:'JetBrains Mono',monospace;font-size:72px;font-weight:700;color:var(--cyan);line-height:1;}
  .sl{font-size:18px;color:var(--dim);margin-top:8px;}
  .ab{background:#0D1117;border:1px solid #30363D;border-radius:8px;padding:30px;font-family:'Fira Code',monospace;font-size:15px;line-height:1.6;color:var(--gray);white-space:pre;}
  .ts{text-align:center;justify-content:center;align-items:center;} .ts h1{font-size:52px;margin-bottom:16px;}
  .st{font-size:24px;color:var(--cyan);font-family:'JetBrains Mono',monospace;margin-bottom:40px;}
  table{width:100%;border-collapse:collapse;margin:16px 0;font-size:18px;}
  th{text-align:left;padding:12px 16px;background:var(--card);color:var(--cyan);font-family:'JetBrains Mono',monospace;font-size:15px;font-weight:600;border-bottom:2px solid var(--cyan);}
  td{padding:10px 16px;border-bottom:1px solid #30363D;color:var(--gray);}
  .pb{display:flex;gap:4px;margin:20px 0;} .pb .s{flex:1;height:6px;background:#30363D;border-radius:3px;} .pb .s.done{background:var(--cyan);} .pb .s.cur{background:var(--orange);}
  .tag{display:inline-block;padding:4px 12px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:600;margin:2px 4px;}
  .tag.csv{background:#1a3a1a;color:#06D6A0;border:1px solid #06D6A0;}
  .tag.json{background:#1a2a3a;color:#00D4FF;border:1px solid #00D4FF;}
  .tag.pq{background:#2a1a3a;color:#D2A8FF;border:1px solid #D2A8FF;}
  .tag.avro{background:#3a2a1a;color:#FF6B35;border:1px solid #FF6B35;}
  .tag.orc{background:#3a1a1a;color:#E63946;border:1px solid #E63946;}
</style>
</head>
<body>

<!-- SLIDE 1: Title -->
<div class="slide ts active">
  <div class="mt">Module 02</div>
  <div class="pb"><div class="s done"></div><div class="s cur"></div><div class="s"></div><div class="s"></div><div class="s"></div><div class="s"></div><div class="s"></div><div class="s"></div><div class="s"></div><div class="s"></div></div>
  <h1>File Formats & Stages</h1>
  <div class="st">How the Framework Reads Data &bull; Where It Finds Data</div>
  <p style="font-size:20px;">10 file formats. 4 stages. Templates for S3, Azure, and GCS.</p>
  <div class="sn">1 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 2: What We're Building -->
<div class="slide">
  <div class="mt">Module 02 &mdash; Overview</div>
  <h2>What We're Building</h2>
  <div style="display:flex;gap:60px;margin-top:40px;justify-content:center;">
    <div style="text-align:center;"><div class="bn">10</div><div class="sl">File Formats</div></div>
    <div style="text-align:center;"><div class="bn">4</div><div class="sl">Internal Stages</div></div>
    <div style="text-align:center;"><div class="bn">3</div><div class="sl">Cloud Templates</div></div>
    <div style="text-align:center;"><div class="bn">5</div><div class="sl">File Types</div></div>
  </div>
  <div style="display:flex;gap:12px;justify-content:center;margin-top:40px;">
    <span class="tag csv">CSV</span>
    <span class="tag json">JSON</span>
    <span class="tag pq">PARQUET</span>
    <span class="tag avro">AVRO</span>
    <span class="tag orc">ORC</span>
  </div>
  <div class="sn">2 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 3: Two Concepts -->
<div class="slide">
  <div class="mt">Module 02 &mdash; Concepts</div>
  <h2>Two Core Concepts</h2>
  <div class="g2">
    <div class="cd hc">
      <h3>File Formats</h3>
      <p style="font-size:20px;margin-bottom:16px;">Define <span class="hl">how</span> to parse source files</p>
      <ul>
        <li>Delimiter (comma, pipe, tab)</li>
        <li>Header row handling</li>
        <li>Null string mapping</li>
        <li>Compression detection</li>
        <li>JSON array handling</li>
      </ul>
    </div>
    <div class="cd wc">
      <h3>Stages</h3>
      <p style="font-size:20px;margin-bottom:16px;">Define <span class="w">where</span> source files live</p>
      <ul>
        <li>Internal (inside Snowflake)</li>
        <li>External (S3, Azure, GCS)</li>
        <li>Directory tables for metadata</li>
        <li>Storage Integrations for auth</li>
        <li>File pattern matching</li>
      </ul>
    </div>
  </div>
  <div class="sn">3 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 4: Named vs Inline -->
<div class="slide">
  <div class="mt">Module 02 &mdash; File Formats</div>
  <h2>Named vs. Inline File Formats</h2>
  <div class="g2">
    <div class="cd" style="border-color:var(--red);">
      <h3 style="color:var(--red);">Inline (Don't Do This)</h3>
      <div class="cb" style="font-size:14px;"><span class="kw">COPY INTO</span> my_table
<span class="kw">FROM</span> @my_stage
<span class="kw">FILE_FORMAT</span> = (
  <span class="kw">TYPE</span> = <span class="s">'CSV'</span>
  <span class="kw">FIELD_DELIMITER</span> = <span class="s">','</span>
  <span class="kw">SKIP_HEADER</span> = <span class="n">1</span>
  <span class="kw">NULL_IF</span> = (<span class="s">'NULL'</span>,<span class="s">''</span>)
);
<span class="c">-- Repeated in EVERY script</span></div>
    </div>
    <div class="cd" style="border-color:var(--green);">
      <h3 style="color:var(--green);">Named (MDF Approach)</h3>
      <div class="cb" style="font-size:14px;"><span class="kw">COPY INTO</span> my_table
<span class="kw">FROM</span> @my_stage
<span class="kw">FILE_FORMAT</span> = MDF_FF_CSV_STANDARD;

<span class="c">-- Change once, applies everywhere</span>
<span class="c">-- Self-documenting name</span>
<span class="c">-- Consistent across all loads</span></div>
    </div>
  </div>
  <div class="sn">4 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 5: CSV Options -->
<div class="slide">
  <div class="mt">Module 02 &mdash; CSV Formats</div>
  <h2>CSV File Format Variants</h2>
  <table>
    <tr><th>Format Name</th><th>Delimiter</th><th>Header</th><th>Use Case</th></tr>
    <tr><td><span class="hl">MDF_FF_CSV_STANDARD</span></td><td>Comma (,)</td><td>Yes</td><td>Default for most CSV files</td></tr>
    <tr><td><span class="hl">MDF_FF_CSV_PIPE</span></td><td>Pipe (|)</td><td>Yes</td><td>Legacy / mainframe extracts</td></tr>
    <tr><td><span class="hl">MDF_FF_CSV_TAB</span></td><td>Tab (\t)</td><td>Yes</td><td>TSV files, spreadsheet exports</td></tr>
    <tr><td><span class="hl">MDF_FF_CSV_NO_HEADER</span></td><td>Comma (,)</td><td>No</td><td>Headerless files, positional mapping</td></tr>
  </table>
  <div class="cb" style="font-size:15px;margin-top:10px;"><span class="c">-- Critical settings (all CSV formats include these):</span>
<span class="kw">NULL_IF</span>                 = (<span class="s">'NULL'</span>, <span class="s">'null'</span>, <span class="s">''</span>, <span class="s">'N/A'</span>, <span class="s">'NA'</span>, <span class="s">'#N/A'</span>)
<span class="kw">ERROR_ON_COLUMN_COUNT_MISMATCH</span> = <span class="n">FALSE</span>  <span class="c">-- Don't break on schema changes</span>
<span class="kw">COMPRESSION</span>             = <span class="s">'AUTO'</span>   <span class="c">-- Detect gzip, bzip2, zstd, etc.</span></div>
  <div class="sn">5 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 6: JSON Options -->
<div class="slide">
  <div class="mt">Module 02 &mdash; JSON Formats</div>
  <h2>JSON File Format Variants</h2>
  <div class="g3">
    <div class="cd hc">
      <h3>MDF_FF_JSON_STANDARD</h3>
      <p style="font-size:16px;">STRIP_OUTER_ARRAY = <span class="g">TRUE</span></p>
      <p style="font-size:16px;">STRIP_NULL_VALUES = <span class="d">FALSE</span></p>
      <p style="font-size:15px;margin-top:12px;color:var(--dim);">Arrays unwrapped into rows. Nulls preserved for schema awareness.</p>
    </div>
    <div class="cd" style="border-color:var(--orange);">
      <h3 style="color:var(--orange);">MDF_FF_JSON_NDJSON</h3>
      <p style="font-size:16px;">STRIP_OUTER_ARRAY = <span class="d">FALSE</span></p>
      <p style="font-size:16px;">One object per line</p>
      <p style="font-size:15px;margin-top:12px;color:var(--dim);">Kafka, Kinesis, Firehose output. No array to strip.</p>
    </div>
    <div class="cd" style="border-color:var(--green);">
      <h3 style="color:var(--green);">MDF_FF_JSON_COMPACT</h3>
      <p style="font-size:16px;">STRIP_OUTER_ARRAY = <span class="g">TRUE</span></p>
      <p style="font-size:16px;">STRIP_NULL_VALUES = <span class="g">TRUE</span></p>
      <p style="font-size:15px;margin-top:12px;color:var(--dim);">Storage-optimized. Null keys removed from VARIANT.</p>
    </div>
  </div>
  <div class="cb" style="font-size:15px;margin-top:16px;"><span class="c">-- STRIP_OUTER_ARRAY transforms this:</span>
[{<span class="s">"id"</span>:1}, {<span class="s">"id"</span>:2}, {<span class="s">"id"</span>:3}]   <span class="c">→  3 separate rows (not 1 row with array)</span></div>
  <div class="sn">6 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 7: Self-Describing Formats -->
<div class="slide">
  <div class="mt">Module 02 &mdash; Binary Formats</div>
  <h2>Self-Describing Formats</h2>
  <p style="margin-bottom:20px;">Parquet, Avro, and ORC carry their schema <span class="hl">inside the file</span>. Minimal config needed.</p>
  <table>
    <tr><th>Format</th><th>Storage</th><th>Schema</th><th>Common Source</th><th>Key Setting</th></tr>
    <tr><td><span class="tag pq">PARQUET</span></td><td>Columnar</td><td>Embedded</td><td>Data lakes, Spark, dbt</td><td>SNAPPY_COMPRESSION</td></tr>
    <tr><td><span class="tag avro">AVRO</span></td><td>Row-based</td><td>Embedded + Evolution</td><td>Kafka, Confluent, NiFi</td><td>COMPRESSION = AUTO</td></tr>
    <tr><td><span class="tag orc">ORC</span></td><td>Columnar</td><td>Embedded</td><td>Hive, legacy Hadoop</td><td>TRIM_SPACE = TRUE</td></tr>
  </table>
  <div class="cb" style="font-size:15px;"><span class="c">-- Parquet: Snowflake can INFER_SCHEMA from the file itself</span>
<span class="kw">SELECT</span> * <span class="kw">FROM</span> <span class="fn">TABLE</span>(
  <span class="fn">INFER_SCHEMA</span>(
    <span class="kw">LOCATION</span> =&gt; <span class="s">'@MDF_STG_INTERNAL_PARQUET'</span>,
    <span class="kw">FILE_FORMAT</span> =&gt; <span class="s">'MDF_FF_PARQUET_STANDARD'</span>
  )
);</div>
  <div class="sn">7 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 8: Stage Types -->
<div class="slide">
  <div class="mt">Module 02 &mdash; Stages</div>
  <h2>Stage Types</h2>
  <div class="ab" style="font-size:14px;margin-bottom:20px;">
  INTERNAL STAGES (Inside Snowflake)
  ├── User Stage   (@~)         Per-user, auto-created     <span style="color:var(--red);">✗ Not for frameworks</span>
  ├── Table Stage  (@%table)    Per-table, auto-created    <span style="color:var(--red);">✗ Too tightly coupled</span>
  └── Named Stage  (@stage)     Explicit, shareable        <span style="color:var(--green);">✓ MDF uses this</span>

  EXTERNAL STAGES (Cloud Storage)
  ├── AWS S3                    s3://bucket/path/          <span style="color:var(--green);">✓ Storage Integration</span>
  ├── Azure Blob / ADLS         azure://account/container/ <span style="color:var(--green);">✓ Storage Integration</span>
  └── Google Cloud Storage      gcs://bucket/path/         <span style="color:var(--green);">✓ Storage Integration</span></div>
  <p><span class="w">Rule:</span> Always use <span class="hl">Storage Integrations</span> for external stages. Never hardcode credentials.</p>
  <div class="sn">8 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 9: Naming Convention -->
<div class="slide">
  <div class="mt">Module 02 &mdash; Naming</div>
  <h2>Naming Convention</h2>
  <div class="g2">
    <div class="cd hc">
      <h3>File Formats</h3>
      <div class="cb" style="font-size:15px;"><span class="c">-- Pattern:</span>
MDF_FF_{TYPE}_{VARIANT}

<span class="c">-- Examples:</span>
MDF_FF_CSV_STANDARD
MDF_FF_CSV_PIPE
MDF_FF_JSON_NDJSON
MDF_FF_PARQUET_STANDARD</div>
    </div>
    <div class="cd wc">
      <h3>Stages</h3>
      <div class="cb" style="font-size:15px;"><span class="c">-- Pattern:</span>
MDF_STG_{SCOPE}_{PURPOSE}

<span class="c">-- Examples:</span>
MDF_STG_INTERNAL_DEV
MDF_STG_INTERNAL_CSV
MDF_STG_EXT_S3_SALES
MDF_STG_EXT_AZURE_HR</div>
    </div>
  </div>
  <p style="margin-top:20px;text-align:center;">You can tell what an object does <span class="hl">just by reading its name</span>.</p>
  <div class="sn">9 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 10: Recap + Next -->
<div class="slide">
  <div class="mt">Module 02 &mdash; Recap</div>
  <h2>Module 02 Complete</h2>
  <div class="g2">
    <div>
      <h3>What We Built</h3>
      <ul>
        <li>4 CSV format variants</li>
        <li>3 JSON format variants</li>
        <li>Parquet, Avro, ORC formats</li>
        <li>4 internal stages with directory tables</li>
        <li>External stage templates (S3/Azure/GCS)</li>
      </ul>
    </div>
    <div>
      <h3>Key Takeaways</h3>
      <ul>
        <li>Named formats over inline definitions</li>
        <li>NULL_IF handles inconsistent source data</li>
        <li>STRIP_OUTER_ARRAY for JSON arrays</li>
        <li>Storage Integrations over hardcoded credentials</li>
        <li>Directory tables for file discovery</li>
      </ul>
    </div>
  </div>
  <div style="margin-top:40px;padding:20px;background:var(--bg2);border-left:4px solid var(--orange);border-radius:4px;">
    <p style="font-size:20px;"><span class="w">Next: Module 03</span> &mdash; Config Tables: The Brain of the Framework</p>
    <p style="font-size:16px;color:var(--dim);">One table. 30+ columns. The single source of truth for every data source.</p>
  </div>
  <div class="sn">10 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<script>
let c=0;const ss=document.querySelectorAll('.slide'),n=ss.length;
function go(i){if(i>=0&&i<n){ss[c].classList.remove('active');c=i;ss[c].classList.add('active');}}
document.addEventListener('keydown',e=>{if(e.key==='ArrowRight'||e.key===' ')go(c+1);if(e.key==='ArrowLeft')go(c-1);});
document.addEventListener('click',e=>{if(e.clientX>window.innerWidth/2)go(c+1);else go(c-1);});
</script>
</body>
</html>
