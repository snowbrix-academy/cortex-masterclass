<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 09 — Monitoring & Dashboards | Snowbrix Academy</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&family=Fira+Code:wght@400;500&display=swap');
  :root{--bg:#1A1A2E;--bg2:#16213E;--card:#0F3460;--cyan:#00D4FF;--orange:#FF6B35;--red:#E63946;--green:#06D6A0;--gray:#B0A8A0;--white:#E8E8E8;--dim:#6B7280;}
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--white);overflow:hidden;height:100vh;width:100vw;}
  .slide{display:none;width:100vw;height:100vh;padding:60px 80px;flex-direction:column;justify-content:center;position:relative;}
  .slide.active{display:flex;}
  .sn{position:absolute;bottom:30px;right:40px;font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--dim);}
  .mt{position:absolute;top:30px;left:40px;font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--cyan);letter-spacing:2px;text-transform:uppercase;}
  .bt{position:absolute;bottom:30px;left:40px;font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--dim);}
  h1{font-family:'JetBrains Mono',monospace;font-size:48px;font-weight:700;line-height:1.2;margin-bottom:24px;}
  h2{font-family:'JetBrains Mono',monospace;font-size:36px;font-weight:700;margin-bottom:20px;line-height:1.3;}
  h3{font-family:'JetBrains Mono',monospace;font-size:24px;font-weight:600;margin-bottom:16px;color:var(--cyan);}
  p,li{font-size:22px;line-height:1.6;color:var(--gray);}
  .hl{color:var(--cyan);} .w{color:var(--orange);} .d{color:var(--red);} .g{color:var(--green);}
  ul{list-style:none;padding-left:0;} ul li{padding:8px 0;padding-left:30px;position:relative;}
  ul li::before{content:'>';position:absolute;left:0;color:var(--cyan);font-family:'JetBrains Mono',monospace;font-weight:700;}
  .cb{background:#0D1117;border:1px solid #30363D;border-radius:8px;padding:24px 28px;font-family:'Fira Code',monospace;font-size:17px;line-height:1.7;color:#C9D1D9;margin:20px 0;white-space:pre;overflow:auto;}
  .cb .kw{color:#FF7B72;} .cb .s{color:#A5D6FF;} .cb .c{color:#8B949E;} .cb .fn{color:#D2A8FF;} .cb .n{color:#79C0FF;}
  .g2{display:grid;grid-template-columns:1fr 1fr;gap:40px;margin-top:20px;}
  .g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:30px;margin-top:20px;}
  .cd{background:var(--bg2);border:1px solid #30363D;border-radius:12px;padding:28px;}
  .cd.hc{border-color:var(--cyan);} .cd.wc{border-color:var(--orange);}
  .bn{font-family:'JetBrains Mono',monospace;font-size:72px;font-weight:700;color:var(--cyan);line-height:1;}
  .sl{font-size:18px;color:var(--dim);margin-top:8px;}
  .ab{background:#0D1117;border:1px solid #30363D;border-radius:8px;padding:30px;font-family:'Fira Code',monospace;font-size:15px;line-height:1.6;color:var(--gray);white-space:pre;}
  .ts{text-align:center;justify-content:center;align-items:center;} .ts h1{font-size:52px;margin-bottom:16px;}
  .st{font-size:24px;color:var(--cyan);font-family:'JetBrains Mono',monospace;margin-bottom:40px;}
  table{width:100%;border-collapse:collapse;margin:16px 0;font-size:18px;}
  th{text-align:left;padding:12px 16px;background:var(--card);color:var(--cyan);font-family:'JetBrains Mono',monospace;font-size:15px;font-weight:600;border-bottom:2px solid var(--cyan);}
  td{padding:10px 16px;border-bottom:1px solid #30363D;color:var(--gray);}
  .pb{display:flex;gap:4px;margin:20px 0;} .pb .s{flex:1;height:6px;background:#30363D;border-radius:3px;} .pb .s.done{background:var(--cyan);} .pb .s.cur{background:var(--orange);}
  .tag{display:inline-block;padding:4px 12px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:600;margin:2px 4px;}
  .tag.healthy{background:#0a2e1a;color:#06D6A0;border:1px solid #06D6A0;}
  .tag.warning{background:#2e2a0a;color:#FFD166;border:1px solid #FFD166;}
  .tag.critical{background:#2e0a0a;color:#E63946;border:1px solid #E63946;}
  .kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:24px;margin-top:24px;}
  .kpi{background:var(--bg2);border:1px solid #30363D;border-radius:12px;padding:24px;text-align:center;}
  .kpi .val{font-family:'JetBrains Mono',monospace;font-size:42px;font-weight:700;color:var(--cyan);line-height:1.2;}
  .kpi .lbl{font-size:14px;color:var(--dim);margin-top:8px;font-family:'JetBrains Mono',monospace;text-transform:uppercase;letter-spacing:1px;}
</style>
</head>
<body>

<!-- SLIDE 1: Title -->
<div class="slide ts active">
  <div class="mt">Module 09</div>
  <div class="pb"><div class="s done"></div><div class="s done"></div><div class="s done"></div><div class="s done"></div><div class="s done"></div><div class="s done"></div><div class="s done"></div><div class="s done"></div><div class="s cur"></div><div class="s"></div></div>
  <h1>Monitoring & Dashboards</h1>
  <div class="st">Observability for the Metadata-Driven Framework</div>
  <p style="font-size:20px;">7 monitoring views. Live Snowsight dashboard. Full operational visibility.</p>
  <div class="sn">1 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 2: Why Monitoring Matters -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Philosophy</div>
  <h2>Why Monitoring Matters</h2>
  <div class="g2">
    <div class="cd" style="border-color:var(--red);">
      <h3 style="color:var(--red);">Without Observability</h3>
      <ul>
        <li>Failures discovered by end users</li>
        <li>No idea how long ingestion takes</li>
        <li>Error patterns invisible</li>
        <li>"Is it working?" requires manual checks</li>
        <li>Stakeholder trust erodes over time</li>
      </ul>
    </div>
    <div class="cd" style="border-color:var(--green);">
      <h3 style="color:var(--green);">With Observability</h3>
      <ul>
        <li>Failures detected in minutes</li>
        <li>P95 duration tracked per source</li>
        <li>Error severity auto-classified</li>
        <li>Live dashboard answers everything</li>
        <li>Data confidence backed by metrics</li>
      </ul>
    </div>
  </div>
  <p style="margin-top:30px;text-align:center;font-size:24px;color:var(--white);">If you can't <span class="hl">see</span> it, you can't <span class="w">fix</span> it.</p>
  <div class="sn">2 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 3: 7 Views Overview -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Overview</div>
  <h2>7 Monitoring Views</h2>
  <table>
    <tr><th>#</th><th>View Name</th><th>Purpose</th><th>Data Source</th></tr>
    <tr><td><span class="hl">1</span></td><td>VW_INGESTION_EXECUTIVE_SUMMARY</td><td>30-day daily KPIs &amp; success rate</td><td>Audit Log</td></tr>
    <tr><td><span class="hl">2</span></td><td>VW_SOURCE_HEALTH</td><td>Per-source health: HEALTHY / WARNING / CRITICAL</td><td>Config + Audit</td></tr>
    <tr><td><span class="hl">3</span></td><td>VW_THROUGHPUT_METRICS</td><td>Hourly rows, files, MB per source</td><td>Audit Log</td></tr>
    <tr><td><span class="hl">4</span></td><td>VW_ERROR_ANALYSIS</td><td>Error patterns with severity classification</td><td>Audit Log</td></tr>
    <tr><td><span class="hl">5</span></td><td>VW_PERFORMANCE_METRICS</td><td>P95 duration, rows/sec per source</td><td>Audit Log</td></tr>
    <tr><td><span class="hl">6</span></td><td>VW_OPERATIONAL_OVERVIEW</td><td>Config census per client</td><td>Config</td></tr>
    <tr><td><span class="hl">7</span></td><td>VW_DAILY_SUMMARY</td><td>Today's ingestion report card</td><td>Audit Log</td></tr>
  </table>
  <p style="margin-top:16px;">All views live in <span class="hl">MDF_CONTROL_DB.MONITORING</span> &mdash; queried via <span class="hl">MDF_MONITORING_WH</span> (XSMALL).</p>
  <div class="sn">3 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 4: Executive Summary -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Executive Summary</div>
  <h2>VW_INGESTION_EXECUTIVE_SUMMARY</h2>
  <p style="margin-bottom:16px;">One row per day. 30-day rolling window. The bird's-eye view.</p>
  <div class="kpi-grid">
    <div class="kpi"><div class="val">98.7%</div><div class="lbl">Success Rate</div></div>
    <div class="kpi"><div class="val">4.2s</div><div class="lbl">Avg Duration</div></div>
    <div class="kpi"><div class="val">1.2M</div><div class="lbl">Rows Loaded</div></div>
    <div class="kpi"><div class="val">847</div><div class="lbl">Total Runs</div></div>
  </div>
  <div class="cb" style="font-size:15px;margin-top:16px;"><span class="kw">SELECT</span>
    RUN_DATE, TOTAL_RUNS, SUCCESS_COUNT, FAILED_COUNT,
    <span class="fn">ROUND</span>(SUCCESS_COUNT * <span class="n">100.0</span> / <span class="fn">NULLIF</span>(TOTAL_RUNS, <span class="n">0</span>), <span class="n">1</span>) <span class="kw">AS</span> SUCCESS_RATE_PCT,
    TOTAL_ROWS_LOADED, TOTAL_MB_LOADED, AVG_DURATION_SECONDS
<span class="kw">FROM</span> daily_stats <span class="kw">ORDER BY</span> RUN_DATE <span class="kw">DESC</span>;</div>
  <div class="sn">4 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 5: Source Health -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Source Health</div>
  <h2>VW_SOURCE_HEALTH</h2>
  <p style="margin-bottom:20px;">Per-source traffic-light indicator. Failures in the last 7 days determine status.</p>
  <div class="g3">
    <div class="cd" style="border-color:var(--green);text-align:center;">
      <div style="font-size:48px;margin-bottom:12px;">&#9679;</div>
      <h3 style="color:var(--green);font-size:28px;">HEALTHY</h3>
      <p style="font-size:18px;">0 failures in 7 days</p>
      <p style="font-size:15px;color:var(--dim);margin-top:8px;">No action required. Pipeline running clean.</p>
    </div>
    <div class="cd" style="border-color:#FFD166;text-align:center;">
      <div style="font-size:48px;margin-bottom:12px;color:#FFD166;">&#9679;</div>
      <h3 style="color:#FFD166;font-size:28px;">WARNING</h3>
      <p style="font-size:18px;">1&ndash;2 failures in 7 days</p>
      <p style="font-size:15px;color:var(--dim);margin-top:8px;">Intermittent issue. Investigate when possible.</p>
    </div>
    <div class="cd" style="border-color:var(--red);text-align:center;">
      <div style="font-size:48px;margin-bottom:12px;color:var(--red);">&#9679;</div>
      <h3 style="color:var(--red);font-size:28px;">CRITICAL</h3>
      <p style="font-size:18px;">3+ failures in 7 days</p>
      <p style="font-size:15px;color:var(--dim);margin-top:8px;">Immediate attention. Source is unreliable.</p>
    </div>
  </div>
  <div class="cb" style="font-size:14px;margin-top:16px;"><span class="kw">CASE</span>
    <span class="kw">WHEN</span> <span class="fn">SUM</span>(<span class="kw">CASE WHEN</span> RUN_STATUS = <span class="s">'FAILED'</span> <span class="kw">THEN</span> <span class="n">1</span> <span class="kw">ELSE</span> <span class="n">0</span> <span class="kw">END</span>) = <span class="n">0</span>    <span class="kw">THEN</span> <span class="s">'HEALTHY'</span>
    <span class="kw">WHEN</span> <span class="fn">SUM</span>(<span class="kw">CASE WHEN</span> RUN_STATUS = <span class="s">'FAILED'</span> <span class="kw">THEN</span> <span class="n">1</span> <span class="kw">ELSE</span> <span class="n">0</span> <span class="kw">END</span>) &lt;= <span class="n">2</span> <span class="kw">THEN</span> <span class="s">'WARNING'</span>
    <span class="kw">ELSE</span> <span class="s">'CRITICAL'</span>
<span class="kw">END AS</span> HEALTH_STATUS</div>
  <div class="sn">5 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 6: Performance Metrics -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Performance</div>
  <h2>VW_PERFORMANCE_METRICS</h2>
  <p style="margin-bottom:16px;">Duration trends per source. P95 is the metric that matters.</p>
  <div class="g2">
    <div>
      <div class="cd hc">
        <h3>Why P95, Not Average?</h3>
        <ul>
          <li>Average hides outliers</li>
          <li>Max is too sensitive to one bad run</li>
          <li>P95 = 95% of runs complete faster than this</li>
          <li>The standard SLA metric in production</li>
        </ul>
      </div>
    </div>
    <div>
      <div class="cd wc">
        <h3>Key Columns</h3>
        <table style="font-size:16px;margin:0;">
          <tr><td><span class="hl">MIN_DURATION_SEC</span></td><td>Best case</td></tr>
          <tr><td><span class="hl">AVG_DURATION_SEC</span></td><td>Typical case</td></tr>
          <tr><td><span class="w">P95_DURATION_SEC</span></td><td>Near-worst case</td></tr>
          <tr><td><span class="hl">MAX_DURATION_SEC</span></td><td>Actual worst</td></tr>
          <tr><td><span class="g">ROWS_PER_SECOND</span></td><td>Throughput velocity</td></tr>
        </table>
      </div>
    </div>
  </div>
  <div class="cb" style="font-size:15px;margin-top:16px;"><span class="fn">PERCENTILE_CONT</span>(<span class="n">0.95</span>) <span class="kw">WITHIN GROUP</span> (<span class="kw">ORDER BY</span> DURATION_SECONDS) <span class="kw">AS</span> P95_DURATION_SEC,
<span class="fn">ROUND</span>(<span class="fn">SUM</span>(ROWS_LOADED) / <span class="fn">NULLIF</span>(<span class="fn">SUM</span>(DURATION_SECONDS), <span class="n">0</span>), <span class="n">0</span>) <span class="kw">AS</span> ROWS_PER_SECOND</div>
  <div class="sn">6 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 7: Error Analysis -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Errors</div>
  <h2>VW_ERROR_ANALYSIS</h2>
  <p style="margin-bottom:16px;">Error pattern detection with automatic severity classification.</p>
  <div class="g2">
    <div>
      <table>
        <tr><th>Severity</th><th>Occurrences</th><th>Action</th></tr>
        <tr><td><span class="d" style="font-weight:700;">CRITICAL</span></td><td>10+</td><td>Immediate fix required</td></tr>
        <tr><td><span class="w" style="font-weight:700;">HIGH</span></td><td>5 &ndash; 9</td><td>Schedule fix this sprint</td></tr>
        <tr><td><span class="hl" style="font-weight:700;">MEDIUM</span></td><td>2 &ndash; 4</td><td>Monitor and investigate</td></tr>
        <tr><td style="color:var(--dim);font-weight:700;">LOW</td><td>1</td><td>Likely transient</td></tr>
      </table>
    </div>
    <div>
      <div class="cd hc">
        <h3>Tracked Per Error</h3>
        <ul>
          <li>SOURCE_NAME &mdash; which source</li>
          <li>ERROR_CODE &mdash; Snowflake error code</li>
          <li>ERROR_PATTERN &mdash; first 200 chars</li>
          <li>FIRST_SEEN / LAST_SEEN</li>
          <li>DURATION_HOURS &mdash; persistence window</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="cb" style="font-size:15px;margin-top:12px;"><span class="kw">SELECT</span> * <span class="kw">FROM</span> VW_ERROR_ANALYSIS
<span class="kw">WHERE</span> SEVERITY <span class="kw">IN</span> (<span class="s">'CRITICAL'</span>, <span class="s">'HIGH'</span>)
<span class="kw">ORDER BY</span> OCCURRENCE_COUNT <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="n">10</span>;</div>
  <div class="sn">7 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 8: Building the Snowsight Dashboard -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Dashboard</div>
  <h2>Building the Snowsight Dashboard</h2>
  <p style="margin-bottom:16px;">Five tiles. One dashboard. Full operational visibility.</p>
  <div class="ab" style="font-size:14px;">
  MDF Ingestion Monitor Dashboard
  ┌────────────────────────────────────────────────────────────────────┐
  │  <span style="color:var(--cyan);">TILE 1: KPI Scorecards</span>          (VW_DAILY_SUMMARY)               │
  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐            │
  │  │  98.7%   │ │   4.2s   │ │   1.2M   │ │    12    │            │
  │  │ Success  │ │ Avg Dur  │ │ Rows     │ │ Sources  │            │
  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘            │
  ├──────────────────────────┬───────────────────────────────────────┤
  │  <span style="color:var(--green);">TILE 2: Source Health</span>    │  <span style="color:var(--orange);">TILE 3: Ingestion Trend</span>             │
  │  (VW_SOURCE_HEALTH)      │  (VW_EXECUTIVE_SUMMARY - Line Chart) │
  │  <span style="color:var(--green);">&#9679; HEALTHY    8</span>        │       ___                             │
  │  <span style="color:#FFD166;">&#9679; WARNING    3</span>        │      /   \    /\                       │
  │  <span style="color:var(--red);">&#9679; CRITICAL   1</span>        │  ___/     \__/  \___                  │
  ├──────────────────────────┼───────────────────────────────────────┤
  │  <span style="color:var(--red);">TILE 4: Top Errors</span>       │  <span style="color:var(--cyan);">TILE 5: P95 Performance</span>             │
  │  (VW_ERROR_ANALYSIS)     │  (VW_PERFORMANCE_METRICS - Bar Chart)│
  │  CRITICAL / HIGH only    │  ████  ██████  ███  ████████         │
  └──────────────────────────┴───────────────────────────────────────┘
  Warehouse: MDF_MONITORING_WH (XSMALL)  |  Auto-refresh: 5 min</div>
  <div class="sn">8 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 9: Recap -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Recap</div>
  <h2>Module 09 Complete</h2>
  <div class="g2">
    <div>
      <h3>7 Monitoring Views</h3>
      <ul>
        <li>Executive Summary &mdash; 30-day KPIs</li>
        <li>Source Health &mdash; traffic-light status</li>
        <li>Throughput Metrics &mdash; hourly volumes</li>
        <li>Error Analysis &mdash; severity classification</li>
        <li>Performance Metrics &mdash; P95 duration</li>
        <li>Operational Overview &mdash; config census</li>
        <li>Daily Summary &mdash; today's report card</li>
      </ul>
    </div>
    <div>
      <h3>Dashboard KPIs</h3>
      <div class="kpi-grid" style="grid-template-columns:1fr 1fr;gap:16px;margin-top:12px;">
        <div class="kpi" style="padding:16px;"><div class="val" style="font-size:28px;">Success %</div><div class="lbl">success / total runs</div></div>
        <div class="kpi" style="padding:16px;"><div class="val" style="font-size:28px;">Avg Dur</div><div class="lbl">mean duration (sec)</div></div>
        <div class="kpi" style="padding:16px;"><div class="val" style="font-size:28px;">Rows</div><div class="lbl">total rows loaded</div></div>
        <div class="kpi" style="padding:16px;"><div class="val" style="font-size:28px;">Sources</div><div class="lbl">active source count</div></div>
      </div>
      <p style="margin-top:16px;font-size:18px;">All on <span class="hl">MDF_MONITORING_WH</span> (XSMALL). Observability doesn't have to be expensive.</p>
    </div>
  </div>
  <div class="sn">9 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<!-- SLIDE 10: Next Module -->
<div class="slide">
  <div class="mt">Module 09 &mdash; Next</div>
  <h2>Next: Module 10</h2>
  <h1 style="color:var(--orange);font-size:44px;margin-top:10px;">Schema Evolution & Advanced Topics</h1>
  <div class="g2" style="margin-top:30px;">
    <div class="cd hc">
      <h3>What's Coming</h3>
      <ul>
        <li>Automatic column detection</li>
        <li>Schema drift handling</li>
        <li>New columns added without breaking loads</li>
        <li>Data type change management</li>
        <li>Production deployment patterns</li>
      </ul>
    </div>
    <div class="cd wc">
      <h3>The Final Module</h3>
      <p style="font-size:18px;margin-bottom:16px;">Sources change. Columns appear. Types shift. The framework handles it automatically.</p>
      <p style="font-size:18px;">The finish line for a production-grade metadata-driven ingestion framework.</p>
    </div>
  </div>
  <div style="margin-top:30px;padding:20px;background:var(--bg2);border-left:4px solid var(--orange);border-radius:4px;">
    <p style="font-size:18px;">SQL scripts in the course repository. Build the views. Create the dashboard. See your framework's health.</p>
  </div>
  <div class="sn">10 / 10</div><div class="bt">snowbrix.academy</div>
</div>

<script>
let c=0;const ss=document.querySelectorAll('.slide'),n=ss.length;
function go(i){if(i>=0&&i<n){ss[c].classList.remove('active');c=i;ss[c].classList.add('active');}}
document.addEventListener('keydown',e=>{if(e.key==='ArrowRight'||e.key===' ')go(c+1);if(e.key==='ArrowLeft')go(c-1);});
document.addEventListener('click',e=>{if(e.clientX>window.innerWidth/2)go(c+1);else go(c-1);});
</script>
</body>
</html>
